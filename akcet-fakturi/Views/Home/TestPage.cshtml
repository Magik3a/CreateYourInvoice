
@{
    ViewBag.Title = "TestPage";
    Layout = "~/Views/Shared/_LayoutUser.cshtml";
}



<div role="tabpanel" class="tab-pane" id="settings">
    <div class="row text-center">
        <div class="col-md-3">
            @*<a href="@Url.Action("DownloadInvoice", "Home")" class="btn btn-success btn-lg" target="_blank">Свали в .pdf</a>*@
            <button class="btn btn-success btn-lg" id="pdf-button">Свали в .pdf</button>
        </div>
        <div class="col-md-3">
            <button class="btn btn-success btn-lg" id="print-button">Принтирай</button>
        </div>
        <div class="col-md-6">
            @using (Ajax.BeginForm("SendIvoiceToEmail", "Home", new AjaxOptions()
            {
                OnBegin = "BeginSendingEmail",
                OnSuccess = "SuccessSendingEmail"
            }))
            {
                <div class="col-md-6">
                    <div class="pull-right">
                        <input style="height: 3.2em;" type="text" class="form-control" id="email-reciever" name="email-reciever" placeholder="Изпрати до имейл">
                    </div>
                </div>
                <div class="col-md-2">
                    <input type="submit" value="Изпрати" class="btn btn-success btn-lg pull-left"/>
                </div>


            }

        </div>
    </div>
    <div id="saved-faktura2">
        @*<iframe style='width: 100%; height: 1200px' src='@Url.Action("Index", "InvoiceTemplate", new {Area = "InvoiceTemplates"})'></iframe>*@
        @Html.Raw(ViewBag.Html)
    </div>

    <div id="editor"></div>
</div>
<script src="~/Scripts/jquery.browser.min.js"></script>
<script src="~/Scripts/jquery.printElement.min.js"></script>
<script src="~/Scripts/jspdf.min.js"></script>

<script>
    //TODO: Print using Jquery or pluging (recomend plugin)
    var doc = new jsPDF();

    var specialElementHandlers = {
        '#editor': function (element, renderer) {
            return true;
        }
    };

    $('#print-button')
        .click(function() {
            $("#saved-faktura2").printElement({ printMode: 'popup' });
        });

    $('#pdf-button').click(function () {
        var html = $("#saved-faktura2").html();
        doc.fromHTML(html, 15, 15, {
            'width': 170,
            'elementHandlers': specialElementHandlers
        });
        doc.save('sample-file.pdf');
    });
</script>

